#ifndef TC_SIZE_CLASSES_H
#define TC_SIZE_CLASSES_H
#include "TCCommon.h"
#include "TCSizeClassInfo.h"
#include "Platform.h"
#include "../Misc/MacroDefine.h"
#include INCLUDE_PLATFORM_HEADER(.., Platform.h)
namespace sablin{

#if (!defined(USE_PLATFORM_ALIGNMENT) && __STDCPP_DEFAULT_NEW_ALIGNMENT__ <= 8u) || MEMORY_ALIGNMENT_DEFAULT == 8u
#define TC_ALIGNMENT_SHIFT 3
#if TC_MALLOC_PAGE_SHIFT == 15
    inline constexpr std::size_t kBucketNum = 73;
    static constexpr TCSizeClassInfo kSizeClassInfoArray[kBucketNum] = {
        {        8,       32},
        {       16,       32},
        {       32,       32},
        {       64,       32},
        {       72,       32},
        {       80,       32},
        {       88,       32},
        {       96,       32},
        {      104,       32},
        {      112,       32},
        {      120,       32},
        {      128,       32},
        {      144,       32},
        {      160,       32},
        {      176,       32},
        {      192,       32},
        {      208,       32},
        {      232,       32},
        {      256,       32},
        {      272,       32},
        {      296,       32},
        {      320,       32},
        {      352,       32},
        {      400,       32},
        {      448,       32},
        {      480,       32},
        {      512,       32},
        {      576,       32},
        {      640,       32},
        {      704,       32},
        {      832,       32},
        {      896,       32},
        {     1024,       32},
        {     1152,       32},
        {     1280,       32},
        {     1408,       32},
        {     1536,       32},
        {     1920,       32},
        {     2048,       32},
        {     2176,       30},
        {     2432,       26},
        {     2688,       24},
        {     3200,       20},
        {     3584,       18},
        {     4096,       16},
        {     4608,       14},
        {     5376,       12},
        {     6528,       10},
        {     7168,        9},
        {     8192,        8},
        {     9344,        7},
        {    10880,        6},
        {    13056,        5},
        {    13952,        4},
        {    16384,        4},
        {    19072,        3},
        {    21760,        3},
        {    24576,        2},
        {    28672,        2},
        {    32768,        2},
        {    38144,        2},
        {    40960,        2},
        {    49152,        2},
        {    57344,        2},
        {    65536,        2},
        {    81920,        2},
        {    98304,        2},
        {   114688,        2},
        {   131072,        2},
        {   163840,        2},
        {   196608,        2},
        {   229376,        2},
        {   262144,        2},
    };
#elif TC_MALLOC_PAGE_SHIFT == 18
    inline constexpr std::size_t kBucketNum = 84;
    static constexpr TCSizeClassInfo kSizeClassInfoArray[kBucketNum] = {
        {        8,       32},
        {       16,       32},
        {       32,       32},
        {       64,       32},
        {       72,       32},
        {       80,       32},
        {       88,       32},
        {       96,       32},
        {      104,       32},
        {      112,       32},
        {      128,       32},
        {      144,       32},
        {      160,       32},
        {      176,       32},
        {      192,       32},
        {      208,       32},
        {      232,       32},
        {      256,       32},
        {      272,       32},
        {      304,       32},
        {      352,       32},
        {      400,       32},
        {      472,       32},
        {      512,       32},
        {      576,       32},
        {      640,       32},
        {      704,       32},
        {      768,       32},
        {      896,       32},
        {     1024,       32},
        {     1152,       32},
        {     1280,       32},
        {     1408,       32},
        {     1536,       32},
        {     1664,       32},
        {     1920,       32},
        {     2048,       32},
        {     2304,       28},
        {     2560,       25},
        {     2816,       23},
        {     3072,       21},
        {     3328,       19},
        {     3584,       18},
        {     3840,       17},
        {     4096,       16},
        {     4352,       15},
        {     4736,       13},
        {     5632,       11},
        {     6528,       10},
        {     7168,        9},
        {     8192,        8},
        {     8704,        7},
        {     9344,        7},
        {     9984,        6},
        {    10880,        6},
        {    11904,        5},
        {    13056,        5},
        {    13696,        4},
        {    14464,        4},
        {    15360,        4},
        {    16384,        4},
        {    17408,        3},
        {    18688,        3},
        {    20096,        3},
        {    21760,        3},
        {    23808,        2},
        {    26112,        2},
        {    29056,        2},
        {    32768,        2},
        {    37376,        2},
        {    43648,        2},
        {    52352,        2},
        {    56064,        2},
        {    65536,        2},
        {    74880,        2},
        {    87296,        2},
        {   104832,        2},
        {   112256,        2},
        {   131072,        2},
        {   149760,        2},
        {   174720,        2},
        {   196608,        2},
        {   209664,        2}, 
        {   262144,        2}, 
    };
#else
    #error "Wrong TCSizeClasses TCMAllocPageShift!"
#endif
#else
#define TC_ALIGNMENT_SHIFT 4
#if TC_MALLOC_PAGE_SHIFT == 15
    inline constexpr std::size_t kBucketNum = 77;
    static constexpr TCSizeClassInfo kSizeClassInfoArray[kBucketNum] = {
        {        8,       32},
        {       16,       32},
        {       32,       32},
        {       48,       32}, // Add New Size
        {       64,       32},
        {       80,       32},
        {       96,       32},
        {      112,       32},
        {      128,       32},
        {      144,       32},
        {      160,       32},
        {      176,       32},
        {      192,       32},
        {      208,       32},
        {      224,       32}, // Add New Size
        {      240,       32}, // Add New Size
        {      256,       32},
        {      288,       32}, // Add New Size
        {      304,       32}, // Add New Size
        {      320,       32},
        {      336,       32}, // Add New Size
        {      352,       32},
        {      368,       32}, // Add New Size
        {      384,       32}, // Add New Size
        {      400,       32},
        {      432,       32}, // Add New Size
        {      448,       32},
        {      480,       32},
        {      512,       32},
        {      576,       32},
        {      640,       32},
        {      704,       32},
        {      832,       32},
        {      896,       32},
        {     1024,       32},
        {     1152,       32},
        {     1280,       32},
        {     1408,       32},
        {     1536,       32},
        {     1920,       32},
        {     2048,       32},
        {     2176,       30},
        {     2432,       28},
        {     2688,       26},
        {     3200,       24},
        {     3584,       20},
        {     4096,       18},
        {     4608,       16},
        {     5376,       14},
        {     6528,       12},
        {     7168,       10},
        {     8192,        9},
        {     9344,        8},
        {    10880,        7},
        {    13056,        6},
        {    13952,        5},
        {    15104,        4}, //Add New Size
        {    16384,        4},
        {    19072,        3},
        {    21760,        3},
        {    24576,        2},
        {    26240,        2}, //Add New Size
        {    28672,        2},
        {    32768,        2},
        {    38144,        2},
        {    40960,        2},
        {    49152,        2},
        {    57344,        2},
        {    65536,        2},
        {    81920,        2},
        {    98304,        2},
        {   114688,        2},
        {   131072,        2},
        {   163840,        2},
        {   196608,        2},
        {   229376,        2},
        {   262144,        2},
    };
#elif TC_MALLOC_PAGE_SHIFT == 18
    inline constexpr std::size_t kBucketNum = 88;
    static constexpr TCSizeClassInfo kSizeClassInfoArray[kBucketNum] = {
        {        8,       32},
        {       16,       32},
        {       32,       32},
        {       48,       32}, // Add New Size
        {       64,       32},
        {       80,       32},
        {       96,       32},
        {      112,       32},
        {      128,       32},
        {      144,       32},
        {      160,       32},
        {      176,       32},
        {      192,       32},
        {      208,       32},
        {      224,       32}, // Add New Size
        {      240,       32}, // Add New Size
        {      256,       32},
        {      272,       32},
        {      288,       32}, // Add New Size
        {      304,       32},
        {      336,       32}, // Add New Size
        {      352,       32},
        {      400,       32},
        {      432,       32}, // Add New Size
        {      472,       32},
        {      512,       32},
        {      576,       32},
        {      640,       32},
        {      704,       32},
        {      768,       32},
        {      896,       32},
        {     1024,       32},
        {     1152,       32},
        {     1280,       32},
        {     1408,       32},
        {     1536,       32},
        {     1664,       32},
        {     1920,       32},
        {     2048,       32},
        {     2304,       32},
        {     2560,       32},
        {     2816,       30},
        {     3072,       28},
        {     3328,       26},
        {     3584,       24},
        {     3840,       20},
        {     4096,       18},
        {     4352,       17},
        {     4736,       16},
        {     5632,       15},
        {     6528,       13},
        {     7168,       12},
        {     8192,       11},
        {     8704,       10},
        {     9344,        9},
        {     9984,        8},
        {    10880,        7},
        {    11904,        7},
        {    12288,        6}, // Add New Size
        {    13056,        6},
        {    13696,        5},
        {    14464,        5},
        {    15360,        4},
        {    16384,        4},
        {    17408,        4},
        {    18688,        4},
        {    20096,        3},
        {    21760,        3},
        {    23808,        3},
        {    24567,        3}, // Add New Size
        {    26112,        2},
        {    29056,        2},
        {    32768,        2},
        {    37376,        2},
        {    43648,        2},
        {    52352,        2},
        {    56064,        2},
        {    65536,        2},
        {    74880,        2},
        {    87296,        2},
        {   104832,        2},
        {   112256,        2},
        {   131072,        2},
        {   149760,        2},
        {   174720,        2},
        {   196608,        2},
        {   209664,        2},
        {   262144,        2},
    };
#else
    #error "Wrong TCSizeClasses TCMAllocPageShift!"
#endif
#endif

}
#endif
