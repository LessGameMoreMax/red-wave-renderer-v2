#ifndef TC_SIZE_CLASSES_H
#define TC_SIZE_CLASSES_H
#include "TCCommon.h"
#include "TCSizeClassInfo.h"
#include "Platform.h"
#include "../Misc/MacroDefine.h"
#include INCLUDE_PLATFORM_HEADER(.., Platform.h)
namespace sablin{

#if (!defined(USE_PLATFORM_ALIGNMENT) && __STDCPP_DEFAULT_NEW_ALIGNMENT__ <= 8u) || MEMORY_ALIGNMENT_DEFAULT == 8u
#define TC_ALIGNMENT_SHIFT 3
#if TC_MALLOC_PAGE_SHIFT == 15
    inline constexpr std::size_t kBucketNum = 73;
    static constexpr TCSizeClassInfo kSizeClassInfoArray[kBucketNum] = {
        {        8,        1,       32},
        {       16,        1,      32},
        {       32,        1,       32},
        {       64,        1,       32},
        {       72,        1,       32},
        {       80,        1,       32},
        {       88,        1,       32},
        {       96,        1,       32},
        {      104,        1,       32},
        {      112,        1,       32},
        {      120,        1,       32},
        {      128,        1,       32},
        {      144,        1,       32},
        {      160,        1,       32},
        {      176,        1,       32},
        {      192,        1,       32},
        {      208,        1,       32},
        {      232,        1,       32},
        {      256,        1,       32},
        {      272,        1,       32},
        {      296,        1,       32},
        {      320,        1,       32},
        {      352,        1,       32},
        {      400,        1,       32},
        {      448,        1,       32},
        {      480,        1,       32},
        {      512,        1,       32},
        {      576,        1,       32},
        {      640,        1,       32},
        {      704,        1,       32},
        {      832,        1,       32},
        {      896,        1,       32},
        {     1024,        1,       32},
        {     1152,        1,       32},
        {     1280,        1,       32},
        {     1408,        1,       32},
        {     1536,        1,       32},
        {     1920,        1,       32},
        {     2048,        1,       32},
        {     2176,        1,       30},
        {     2432,        1,       26},
        {     2688,        1,       24},
        {     3200,        1,       20},
        {     3584,        1,       18},
        {     4096,        1,       16},
        {     4608,        1,       14},
        {     5376,        1,       12},
        {     6528,        1,       10},
        {     7168,        2,        9},
        {     8192,        1,        8},
        {     9344,        2,        7},
        {    10880,        1,        6},
        {    13056,        2,        5},
        {    13952,        3,        4},
        {    16384,        1,        4},
        {    19072,        3,        3},
        {    21760,        2,        3},
        {    24576,        3,        2},
        {    28672,        7,        2},
        {    32768,        1,        2},
        {    38144,        5,        2},
        {    40960,        4,        2},
        {    49152,        3,        2},
        {    57344,        7,        2},
        {    65536,        2,        2},
        {    81920,        5,        2},
        {    98304,        3,        2},
        {   114688,        7,        2},
        {   131072,        4,        2},
        {   163840,        5,        2},
        {   196608,        6,        2},
        {   229376,        7,        2},
        {   262144,        8,        2},
    };
#elif TC_MALLOC_PAGE_SHIFT == 18
    inline constexpr std::size_t kBucketNum = 84;
    static constexpr TCSizeClassInfo kSizeClassInfoArray[kBucketNum] = {
        {        8,        1,       32},
        {       16,        1,       32},
        {       32,        1,       32},
        {       64,        1,       32},
        {       72,        1,       32},
        {       80,        1,       32},
        {       88,        1,       32},
        {       96,        1,       32},
        {      104,        1,       32},
        {      112,        1,       32},
        {      128,        1,       32},
        {      144,        1,       32},
        {      160,        1,       32},
        {      176,        1,       32},
        {      192,        1,       32},
        {      208,        1,       32},
        {      232,        1,       32},
        {      256,        1,       32},
        {      272,        1,       32},
        {      304,        1,       32},
        {      352,        1,       32},
        {      400,        1,       32},
        {      472,        1,       32},
        {      512,        1,       32},
        {      576,        1,       32},
        {      640,        1,       32},
        {      704,        1,       32},
        {      768,        1,       32},
        {      896,        1,       32},
        {     1024,        1,       32},
        {     1152,        1,       32},
        {     1280,        1,       32},
        {     1408,        1,       32},
        {     1536,        1,       32},
        {     1664,        1,       32},
        {     1920,        1,       32},
        {     2048,        1,       32},
        {     2304,        1,       28},
        {     2560,        1,       25},
        {     2816,        1,       23},
        {     3072,        1,       21},
        {     3328,        1,       19},
        {     3584,        1,       18},
        {     3840,        1,       17},
        {     4096,        1,       16},
        {     4352,        1,       15},
        {     4736,        1,       13},
        {     5632,        1,       11},
        {     6528,        1,       10},
        {     7168,        1,        9},
        {     8192,        1,        8},
        {     8704,        1,        7},
        {     9344,        1,        7},
        {     9984,        1,        6},
        {    10880,        1,        6},
        {    11904,        1,        5},
        {    13056,        1,        5},
        {    13696,        1,        4},
        {    14464,        1,        4},
        {    15360,        1,        4},
        {    16384,        1,        4},
        {    17408,        1,        3},
        {    18688,        1,        3},
        {    20096,        1,        3},
        {    21760,        1,        3},
        {    23808,        1,        2},
        {    26112,        1,        2},
        {    29056,        1,        2},
        {    32768,        1,        2},
        {    37376,        1,        2},
        {    43648,        1,        2},
        {    52352,        1,        2},
        {    56064,        2,        2},
        {    65536,        1,        2},
        {    74880,        2,        2},
        {    87296,        1,        2},
        {   104832,        2,        2},
        {   112256,        3,        2},
        {   131072,        1,        2},
        {   149760,        3,        2},
        {   174720,        2,        2},
        {   196608,        3,        2},
        {   209664,        4,        2}, 
        {   262144,        1,        2}, 
    };
#else
    #error "Wrong TCSizeClasses TCMAllocPageShift!"
#endif
#else
#define TC_ALIGNMENT_SHIFT 4
#if TC_MALLOC_PAGE_SHIFT == 15
    inline constexpr std::size_t kBucketNum = 77;
    static constexpr TCSizeClassInfo kSizeClassInfoArray[kBucketNum] = {
        {        8,        1,       32},
        {       16,        1,       32},
        {       32,        1,       32},
        {       48,        1,       32}, // Add New Size
        {       64,        1,       32},
        {       80,        1,       32},
        {       96,        1,       32},
        {      112,        1,       32},
        {      128,        1,       32},
        {      144,        1,       32},
        {      160,        1,       32},
        {      176,        1,       32},
        {      192,        1,       32},
        {      208,        1,       32},
        {      224,        1,       32}, // Add New Size
        {      240,        1,       32}, // Add New Size
        {      256,        1,       32},
        {      288,        1,       32}, // Add New Size
        {      304,        1,       32}, // Add New Size
        {      320,        1,       32},
        {      336,        1,       32}, // Add New Size
        {      352,        1,       32},
        {      368,        1,       32}, // Add New Size
        {      384,        1,       32}, // Add New Size
        {      400,        1,       32},
        {      432,        1,       32}, // Add New Size
        {      448,        1,       32},
        {      480,        1,       32},
        {      512,        1,       32},
        {      576,        1,       32},
        {      640,        1,       32},
        {      704,        1,       32},
        {      832,        1,       32},
        {      896,        1,       32},
        {     1024,        1,       32},
        {     1152,        1,       32},
        {     1280,        1,       32},
        {     1408,        1,       32},
        {     1536,        1,       32},
        {     1920,        1,       32},
        {     2048,        1,       32},
        {     2176,        1,       30},
        {     2432,        1,       28},
        {     2688,        1,       26},
        {     3200,        1,       24},
        {     3584,        1,       20},
        {     4096,        1,       18},
        {     4608,        1,       16},
        {     5376,        1,       14},
        {     6528,        1,       12},
        {     7168,        2,       10},
        {     8192,        1,        9},
        {     9344,        2,        8},
        {    10880,        1,        7},
        {    13056,        2,        6},
        {    13952,        3,        5},
        {    15104,        1,        4}, //Add New Size
        {    16384,        1,        4},
        {    19072,        3,        3},
        {    21760,        2,        3},
        {    24576,        3,        2},
        {    26240,        4,        2}, //Add New Size
        {    28672,        7,        2},
        {    32768,        1,        2},
        {    38144,        5,        2},
        {    40960,        4,        2},
        {    49152,        3,        2},
        {    57344,        7,        2},
        {    65536,        2,        2},
        {    81920,        5,        2},
        {    98304,        3,        2},
        {   114688,        7,        2},
        {   131072,        4,        2},
        {   163840,        5,        2},
        {   196608,        6,        2},
        {   229376,        7,        2},
        {   262144,        8,        2},
    };
#elif TC_MALLOC_PAGE_SHIFT == 18
    inline constexpr std::size_t kBucketNum = 88;
    static constexpr TCSizeClassInfo kSizeClassInfoArray[kBucketNum] = {
        {        8,        1,       32},
        {       16,        1,       32},
        {       32,        1,       32},
        {       48,        1,       32}, // Add New Size
        {       64,        1,       32},
        {       80,        1,       32},
        {       96,        1,       32},
        {      112,        1,       32},
        {      128,        1,       32},
        {      144,        1,       32},
        {      160,        1,       32},
        {      176,        1,       32},
        {      192,        1,       32},
        {      208,        1,       32},
        {      224,        1,       32}, // Add New Size
        {      240,        1,       32}, // Add New Size
        {      256,        1,       32},
        {      272,        1,       32},
        {      288,        1,       32}, // Add New Size
        {      304,        1,       32},
        {      336,        1,       32}, // Add New Size
        {      352,        1,       32},
        {      400,        1,       32},
        {      432,        1,       32}, // Add New Size
        {      472,        1,       32},
        {      512,        1,       32},
        {      576,        1,       32},
        {      640,        1,       32},
        {      704,        1,       32},
        {      768,        1,       32},
        {      896,        1,       32},
        {     1024,        1,       32},
        {     1152,        1,       32},
        {     1280,        1,       32},
        {     1408,        1,       32},
        {     1536,        1,       32},
        {     1664,        1,       32},
        {     1920,        1,       32},
        {     2048,        1,       32},
        {     2304,        1,       32},
        {     2560,        1,       32},
        {     2816,        1,       30},
        {     3072,        1,       28},
        {     3328,        1,       26},
        {     3584,        1,       24},
        {     3840,        1,       20},
        {     4096,        1,       18},
        {     4352,        1,       17},
        {     4736,        1,       16},
        {     5632,        1,       15},
        {     6528,        1,       13},
        {     7168,        1,       12},
        {     8192,        1,       11},
        {     8704,        1,       10},
        {     9344,        1,        9},
        {     9984,        1,        8},
        {    10880,        1,        7},
        {    11904,        1,        7},
        {    12288,        1,        6}, // Add New Size
        {    13056,        1,        6},
        {    13696,        1,        5},
        {    14464,        1,        5},
        {    15360,        1,        4},
        {    16384,        1,        4},
        {    17408,        1,        4},
        {    18688,        1,        4},
        {    20096,        1,        3},
        {    21760,        1,        3},
        {    23808,        1,        3},
        {    24567,        1,        3}, // Add New Size
        {    26112,        1,        2},
        {    29056,        1,        2},
        {    32768,        1,        2},
        {    37376,        1,        2},
        {    43648,        1,        2},
        {    52352,        1,        2},
        {    56064,        2,        2},
        {    65536,        1,        2},
        {    74880,        2,        2},
        {    87296,        1,        2},
        {   104832,        2,        2},
        {   112256,        3,        2},
        {   131072,        1,        2},
        {   149760,        3,        2},
        {   174720,        2,        2},
        {   196608,        3,        2},
        {   209664,        4,        2},
        {   262144,        1,        2},
    };
#else
    #error "Wrong TCSizeClasses TCMAllocPageShift!"
#endif
#endif

}
#endif
